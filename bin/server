#!/usr/bin/env php
<?php

use Sws\Application;
use Sws\Rpc\Application as RpcApp;

define('BASE_PATH', dirname(__DIR__) );

require dirname(__DIR__) . '/boot/web.php';

/**
 * @var \Inhere\Server\BoxServer $app
 */
$app = $di->get('app');
//$app = new \Sws\server\WebSocketServer($config);
//$app = new \inhere\server\BoxServer($config);

$rpcServer = new RpcApp([
    'host' => '0.0.0.0',
    'port' => '9762',
]);

$app->attachListener('rpc', $rpcServer);

$app->on(Application::ON_BOOTSTRAP, function ($app) {
    // load ws modules
    require dirname(__DIR__) . '/app/Ws/modules.php';
});

/**
 * do run
 * @var Application $app
 */
$app->run();
